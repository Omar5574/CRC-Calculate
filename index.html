<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRC Lab V15.3 (Clean UI)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Fira+Code:wght@500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Desktop Defaults */
            --cell-size: 45px;
            --font-size: 20px;
            --arrow-size: 24px;
            --msb-top: -18px;
        }

        /* Mobile Adjustments */
        @media (max-width: 768px) {
            :root {
                --cell-size: 32px; /* Smaller cells for mobile */
                --font-size: 14px;
                --arrow-size: 18px;
                --msb-top: -14px;
            }
        }

        body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; overflow-x: hidden; }
        .font-mono { font-family: 'Fira Code', monospace; } 
        
        .math-board-wrapper {
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            overflow-x: auto; /* Essential for mobile scroll */
            overflow-y: hidden;
            padding: 15px; 
            min-height: 50vh;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            -webkit-overflow-scrolling: touch; /* Smooth scroll on iOS */
        }

        /* Scrollbar Styling - ÙˆØ§Ø¶Ø­Ø© ÙˆØªØºÙ†ÙŠ Ø¹Ù† Ø§Ù„Ù€ Hint */
        .math-board-wrapper::-webkit-scrollbar { height: 8px; }
        .math-board-wrapper::-webkit-scrollbar-thumb { background-color: #94a3b8; border-radius: 10px; } /* Darker thumb */
        .math-board-wrapper::-webkit-scrollbar-track { background-color: #e2e8f0; border-radius: 10px; }

        .math-grid {
            display: grid;
            gap: 0px; 
            direction: ltr; 
        }

        .cell {
            width: var(--cell-size); 
            height: var(--cell-size); 
            font-size: var(--font-size);
            display: flex; align-items: center; justify-content: center;
            font-family: 'Fira Code', monospace;
            font-weight: 700;
            color: #334155; position: relative;
            transition: all 0.2s ease; /* Smooth resizing */
        }

        /* Styles */
        .cell.quotient { color: #64748b; font-size: calc(var(--font-size) * 0.8); border-bottom: none; }
        .cell.dividend { background-color: #f8fafc; border-top: 4px solid #1e2937; border-bottom: none; }
        .cell.divisor { color: #0f172a; font-weight: 900; }
        .cell.subtrahend { color: #475569; }
        .cell.line { border-bottom: 3px solid #1e2937; height: 50%; align-self: start; }
        
        .cell.pattern { 
            color: #0f172a; font-weight: 800; background-color: #fffbeb; 
            border-bottom: 1px dashed #e2e8f0;
        } 
        .cell.pattern.new-bit {
            color: #2563eb; background-color: #eff6ff; border: 2px dashed #60a5fa; border-radius: 6px;
        }

        .cell.padding { color: #2563eb; font-weight: 900; background-color: #eff6ff; border-bottom: 2px solid #bfdbfe; } 
        
        .cell.arrow { color: #ef4444; font-size: var(--arrow-size); font-weight: 900; z-index: 20; animation: bounceArrow 1s infinite; }
        
        /* MSB Indicator */
        .msb-indicator {
            position: absolute; top: var(--msb-top); left: 50%; transform: translateX(-50%);
            background-color: #f59e0b; color: white; padding: 1px 4px;
            border-radius: 4px; font-size: 9px; font-weight: bold; white-space: nowrap;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1); z-index: 50; animation: fadeIn 0.3s;
        }
        @media (max-width: 768px) { .msb-indicator { font-size: 8px; padding: 0 2px; } }

        .msb-indicator::after {
            content: ''; position: absolute; bottom: -4px; left: 50%; transform: translateX(-50%);
            border-width: 4px 4px 0; border-style: solid; border-color: #f59e0b transparent transparent transparent;
        }

        @keyframes bounceArrow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -5px); } to { opacity: 1; transform: translate(-50%, 0); } }

        .bracket-wall { border-right: 4px solid #1e2937; height: 100%; position: absolute; right: 0; top: 0; z-index: 5; }

        /* Controls Bar */
        .controls-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(8px);
            padding: 12px 20px;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.05);
            z-index: 100; 
            display: flex; justify-content: space-between; align-items: center; 
            border-top: 1px solid #e2e8f0;
            flex-wrap: wrap; gap: 10px;
        }

        .why-box {
            background-color: #fff7ed; border-right: 5px solid #ea580c;
            padding: 15px; border-radius: 8px; margin-bottom: 20px;
            font-size: 1rem; color: #9a3412; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* Rx Mode */
        body.rx-active .cell.padding { color: #059669; background-color: #ecfdf5; border-color: #6ee7b7; }
        body.rx-active .msb-indicator { background-color: #059669; }
        body.rx-active .msb-indicator::after { border-color: #059669 transparent transparent transparent; }
    </style>
</head>
<body class="pb-36 md:pb-40">

    <!-- Header -->
    <header class="bg-slate-900 text-white py-4 px-4 md:px-8 shadow-lg sticky top-0 z-40">
        <div class="flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center justify-between w-full md:w-auto">
                <h1 class="text-xl md:text-3xl font-bold text-yellow-400 font-mono tracking-wider">CRC Lab V15.3</h1>
            </div>
            
            <div class="flex bg-slate-800 rounded-lg p-1 text-xs md:text-sm border border-slate-700 w-full md:w-auto justify-center">
                <button onclick="setMode('tx')" id="tabTx" class="flex-1 md:flex-none px-4 py-2 rounded-md font-bold transition flex gap-2 items-center justify-center bg-blue-600 text-white shadow-md">
                    <span>ğŸ“¡</span> Transmit
                </button>
                <button onclick="setMode('rx')" id="tabRx" class="flex-1 md:flex-none px-4 py-2 rounded-md transition flex gap-2 items-center justify-center text-slate-400 hover:text-white hover:bg-slate-700">
                    <span>ğŸ“¥</span> Receive
                </button>
            </div>
        </div>
    </header>

    <main class="w-full px-4 md:px-8 py-4 md:py-8 space-y-6">

        <!-- Input Area -->
        <div class="bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-slate-200 grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
            <div class="md:col-span-5">
                <label class="text-xs font-bold text-slate-500 uppercase block mb-1" id="labelData">Ø§Ù„Ø±Ø³Ø§Ù„Ø© (Message)</label>
                <input type="text" id="inData" value="1010001101" class="w-full p-3 border-2 border-slate-200 rounded-xl font-mono text-center font-bold text-lg focus:border-blue-500 outline-none transition text-slate-700">
            </div>
            <div class="md:col-span-4">
                <label class="text-xs font-bold text-slate-500 uppercase block mb-1">Ø§Ù„Ù…ÙˆÙ„Ø¯ (Divisor)</label>
                <input type="text" id="inPoly" value="110101" class="w-full p-3 border-2 border-slate-200 rounded-xl font-mono text-center font-bold text-lg focus:border-blue-500 outline-none transition text-slate-700">
            </div>
            
            <div class="md:col-span-3 flex gap-2">
                <div id="rxTools" class="hidden flex-1">
                    <button onclick="injectError()" class="w-full bg-red-50 text-red-600 border border-red-200 px-4 py-3 rounded-xl font-bold hover:bg-red-100 transition h-[52px] flex items-center justify-center gap-2 text-sm">
                        <span>âš¡</span> ØªØ´ÙˆÙŠØ´
                    </button>
                </div>

                <button onclick="resetSim()" class="flex-1 bg-slate-800 text-white px-6 py-3 rounded-xl font-bold hover:bg-slate-900 transition shadow-lg transform active:scale-95 flex items-center justify-center gap-2 text-sm md:text-lg h-[52px]">
                    <span>ğŸ”„</span> <span>Ø§Ø¨Ø¯Ø£</span>
                </button>
            </div>
        </div>

        <!-- Explanation -->
        <div class="w-full max-w-7xl mx-auto">
            <div class="why-box fade-in" id="doctorBox">
                <strong>ğŸ‘¨â€ğŸ« Ø´Ø±Ø­ Ø§Ù„Ø®Ø·ÙˆØ©:</strong> <span id="explainText">Ø§Ø¶ØºØ· "Ø§Ø¨Ø¯Ø£" Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.</span>
            </div>
        </div>

        <!-- The Big Board -->
        <div class="math-board-wrapper relative" id="boardContainer">
            <!-- Scroll Hint Removed (Scrollbar is enough) -->
            <div id="mathBoard" class="math-grid"></div>
        </div>

        <!-- Result Section -->
        <div id="resultSection" class="hidden bg-white border-4 border-emerald-100 rounded-2xl p-6 md:p-10 text-center max-w-3xl mx-auto mt-8 shadow-xl">
            <h2 class="text-xl md:text-2xl font-bold text-emerald-800 mb-4" id="resTitle">âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
            <div class="text-4xl md:text-6xl font-mono text-emerald-600 font-bold tracking-widest mb-4 drop-shadow-sm break-all" id="finalFCS"></div>
            <p class="text-sm md:text-lg text-slate-600 font-medium bg-emerald-50 py-3 px-6 rounded-lg inline-block border border-emerald-100" id="resDesc"></p>
        </div>

    </main>

    <!-- Bottom Controls -->
    <div class="controls-bar flex-col md:flex-row gap-3">
        <div class="flex w-full md:w-auto gap-3">
            <button onclick="prevStep()" id="btnPrev" disabled class="flex-1 md:flex-none bg-slate-100 text-slate-500 hover:bg-slate-200 px-6 py-3 rounded-xl font-bold text-base transition flex items-center justify-center gap-2 disabled:opacity-40 border border-slate-300">
                <span>â¬…ï¸</span> Ø³Ø§Ø¨Ù‚
            </button>
            
            <button onclick="nextStep()" id="btnNext" disabled class="flex-[2] md:flex-none bg-blue-600 text-white hover:bg-blue-700 px-8 md:px-12 py-3 rounded-xl font-bold text-lg md:text-xl shadow-xl transition flex items-center justify-center gap-3 disabled:bg-slate-300 disabled:cursor-not-allowed transform active:scale-[0.98]">
                <span id="btnNextText">Ø§Ù„ØªØ§Ù„ÙŠ</span> <span>â¡ï¸</span>
            </button>
        </div>
    </div>

    <script>
        // --- State ---
        let mode = 'tx';
        let queue = [];
        let cursor = 0;
        let historyStack = [];

        // --- Core Logic ---
        function planSteps(data, poly) {
            let q = [];
            
            let paddingCount = (mode === 'tx') ? poly.length - 1 : 0;
            let fullDividend = data + '0'.repeat(paddingCount);
            let dividendArr = fullDividend.split('');
            let polyLen = poly.length;
            
            const totalCols = polyLen + 1 + fullDividend.length;
            
            q.push({
                op: 'setup', data, poly, padded: fullDividend, padding: paddingCount, 
                startCol: polyLen + 1, totalCols: totalCols,
                explain: (mode === 'tx') 
                    ? `<strong>Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</strong> Ø§Ù„Ø±Ø³Ø§Ù„Ø© + <span class="text-blue-600 font-bold">${paddingCount} Ø£ØµÙØ§Ø± Ø²Ø±Ù‚Ø§Ø¡</span> (Padding).`
                    : `<strong>Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</strong> Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„Ø©.`
            });

            let currentWindow = dividendArr.slice(0, polyLen);
            let nextBitPointer = polyLen; 
            let currentRow = 2; 
            let currentCol = polyLen + 1; 

            while (true) {
                let msb = currentWindow[0];
                let workRow = currentRow + 1;

                q.push({
                    op: 'quotient', val: (msb === '1' ? '1' : '0'), col: currentCol,
                    explain: (msb === '1') ? `Ø§Ù„Ù€ <strong>MSB=1</strong> â† Ø§Ù„Ù†Ø§ØªØ¬ ÙÙˆÙ‚ 1.` : `Ø§Ù„Ù€ <strong>MSB=0</strong> â† Ø§Ù„Ù†Ø§ØªØ¬ ÙÙˆÙ‚ 0.`
                });

                if (msb === '0') {
                    if (nextBitPointer < dividendArr.length) {
                        let nextBit = dividendArr[nextBitPointer];
                        let newWindow = currentWindow.slice(1);
                        newWindow.push(nextBit);
                        
                        currentCol++; 
                        
                        q.push({
                            op: 'rewrite_pattern',
                            pattern: newWindow,
                            row: workRow, 
                            col: currentCol,
                            newBitVal: nextBit,
                            msbCol: currentCol, 
                            explain: `Ø§Ù„Ù€ <strong>MSB=0</strong>: Ù…Ø´ Ù‡Ù†Ø·Ø±Ø­. <br>Ù‡Ù†Ø±Ø­Ù„ (Shift) ÙˆÙ†Ù†Ø²Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù„ÙŠ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø¯ÙˆØ± <strong>(${nextBit})</strong>.<br>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¨Ù‚Ù‰: <code>${newWindow.join('')}</code>.`
                        });
                        
                        currentWindow = newWindow;
                        nextBitPointer++;
                        currentRow += 1; 
                        
                    } else {
                        q.push({ op: 'info', explain: "Ø§Ù„Ù€ MSB Ø¨ØµÙØ± ÙˆÙ…ÙÙŠØ´ Ø£Ø±Ù‚Ø§Ù… ØªØ§Ù†ÙŠ. Ø®Ù„ØµÙ†Ø§." });
                        break;
                    }

                } else {
                    q.push({
                        op: 'subtrahend', val: poly, row: workRow, col: currentCol,
                        msbCol: currentCol,
                        explain: `Ø§Ù„Ù€ <strong>MSB=1</strong>: Ù†ÙƒØªØ¨ <code>${poly}</code> ÙˆÙ†Ø¹Ù…Ù„ XOR.`
                    });

                    q.push({
                        op: 'line', len: polyLen, row: workRow + 1, col: currentCol
                    });

                    let xorResult = [];
                    for(let k=0; k<polyLen; k++) xorResult.push(currentWindow[k] === poly[k] ? '0' : '1');
                    
                    let newWindow = xorResult.slice(1); 
                    
                    if (nextBitPointer < dividendArr.length) {
                        let nextBit = dividendArr[nextBitPointer];
                        newWindow.push(nextBit);
                        
                        currentCol++; 
                        
                        q.push({
                            op: 'rewrite_pattern',
                            pattern: newWindow,
                            row: workRow + 2,
                            col: currentCol,
                            newBitVal: nextBit,
                            msbCol: currentCol,
                            explain: `Ø§Ù„Ù†Ø§ØªØ¬ XOR Ù‡Ùˆ <code>${xorResult.slice(1).join('')}</code>.<br>Ù†Ø²Ù„Ù†Ø§ Ø¹Ù„ÙŠÙ‡ <strong>${nextBit}</strong>.<br>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¨Ù‚Ù‰: <code class="bg-yellow-100 border border-yellow-400 px-1 rounded">${newWindow.join('')}</code>.`
                        });
                        
                        currentWindow = newWindow;
                        nextBitPointer++;
                        currentRow += 3; 

                    } else {
                        currentWindow = xorResult.slice(1);
                        q.push({
                            op: 'result_final', val: currentWindow.join(''), 
                            row: workRow+2, col: currentCol + 1, 
                            explain: `Ø®Ù„ØµÙ†Ø§! Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù‡Ùˆ.`
                        });
                        break;
                    }
                }
            }

            let finalCRC = currentWindow.slice(currentWindow.length - (polyLen - 1)).join('');
            return { q, finalCRC, totalCols };
        }

        // --- Drawing ---
        function draw(step) {
            const board = document.getElementById('mathBoard');
            let addedElements = [];
            const addEl = (el) => { board.appendChild(el); addedElements.push(el); };

            if(step.op === 'setup') {
                // Responsive Grid Columns using variable
                board.style.gridTemplateColumns = `repeat(${step.totalCols + 2}, var(--cell-size))`;
                
                for(let i=0; i<step.poly.length; i++) addEl(createCell(2, 1+i, step.poly[i], 'divisor'));
                let bracket = createCell(2, step.poly.length, '', 'bracket');
                bracket.appendChild(createWall());
                addEl(bracket);
                for(let i=0; i<step.padded.length; i++) {
                    let type = (mode === 'tx' && i >= step.padded.length - step.padding) ? 'padding' : 'dividend';
                    if (mode === 'rx' && i >= step.padded.length - (step.poly.length - 1)) type = 'padding';
                    let c = createCell(2, step.startCol+i, step.padded[i], type);
                    if(i===0) addMSB(c);
                    addEl(c);
                }
                document.body.className = (mode==='rx') ? 'rx-active' : '';
            }
            else if(step.op === 'quotient') {
                addEl(createCell(1, step.col, step.val, 'quotient'));
            }
            else if(step.op === 'subtrahend') {
                for(let i=0; i<step.val.length; i++) addEl(createCell(step.row, step.col+i, step.val[i], 'subtrahend'));
            }
            else if(step.op === 'line') {
                for(let i=0; i<step.len; i++) addEl(createCell(step.row, step.col+i, '', 'line'));
            }
            else if(step.op === 'rewrite_pattern') {
                step.pattern.forEach((bit, idx) => {
                    let isNew = (idx === step.pattern.length - 1);
                    let type = isNew ? 'pattern new-bit' : 'pattern';
                    let c = createCell(step.row, step.col+idx, bit, type);
                    if(idx===0) addMSB(c); 
                    addEl(c);
                });
            }
            else if(step.op === 'result_final') {
                for(let i=0; i<step.val.length; i++) addEl(createCell(step.row, step.col+i, step.val[i], 'result'));
            }
            
            if(cursor === queue.length - 1) showResults(window.finalRes);
            return addedElements;
        }

        function createCell(row, col, text, type) {
            const div = document.createElement('div');
            div.className = `cell ${type}`;
            div.style.gridRow = row;
            div.style.gridColumn = col;
            div.innerText = text;
            return div;
        }

        function createWall() {
            const d = document.createElement('div');
            d.className = 'bracket-wall';
            return d;
        }

        function addMSB(cell) {
            const m = document.createElement('div');
            m.className = 'msb-indicator';
            m.innerText = 'MSB';
            cell.appendChild(m);
            cell.style.overflow = 'visible';
        }

        // --- Interaction ---
        function setMode(m) {
            mode = m;
            
            const activeStyle = "flex-1 md:flex-none px-4 py-2 rounded-md font-bold transition flex gap-2 items-center justify-center bg-blue-600 text-white shadow-md";
            const inactiveStyle = "flex-1 md:flex-none px-4 py-2 rounded-md transition flex gap-2 items-center justify-center text-slate-400 hover:text-white hover:bg-slate-700";
            
            document.getElementById('tabTx').className = (m === 'tx') ? activeStyle : inactiveStyle;
            document.getElementById('tabRx').className = (m === 'rx') ? activeStyle : inactiveStyle;

            const labelEl = document.getElementById('labelData');
            if(labelEl) labelEl.innerText = (m==='tx') ? "Ø§Ù„Ø±Ø³Ø§Ù„Ø© (Data)" : "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„Ø©";
            
            if(m==='rx') {
                document.getElementById('rxTools').classList.remove('hidden');
                document.getElementById('inData').value = '101000110101110'; 
            } else {
                document.getElementById('rxTools').classList.add('hidden');
                document.getElementById('inData').value = '1010001101';
            }
            document.getElementById('inPoly').value = '110101';
            resetSim();
        }

        function injectError() {
            let val = document.getElementById('inData').value.split('');
            let idx = Math.floor(Math.random()*val.length);
            val[idx] = val[idx] === '0' ? '1' : '0';
            document.getElementById('inData').value = val.join('');
            resetSim();
            document.getElementById('explainText').innerHTML = `<span class="text-red-600 font-bold">âš ï¸ ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Øª Ø±Ù‚Ù… ${idx+1}!</span>`;
        }

        function resetSim() {
            const d = document.getElementById('inData').value;
            const p = document.getElementById('inPoly').value;
            if(!d || p.length < 2) return alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");

            document.getElementById('mathBoard').innerHTML = '';
            document.getElementById('resultSection').classList.add('hidden');

            const plan = planSteps(d, p);
            queue = plan.q;
            window.finalRes = plan.finalCRC;
            cursor = 0;
            historyStack = [];

            document.getElementById('btnNext').disabled = false;
            document.getElementById('btnPrev').disabled = true;
            document.getElementById('btnNextText').innerText = "Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©";

            nextStep(); 
        }

        function nextStep() {
            if(cursor >= queue.length) return;
            const step = queue[cursor];
            const els = draw(step);
            historyStack.push(els);
            if(step.explain) document.getElementById('explainText').innerHTML = step.explain;
            cursor++;
            updateButtons();
            
            const board = document.getElementById('mathBoard');
            if(board.parentElement) board.parentElement.scrollTop = board.parentElement.scrollHeight;
        }

        function prevStep() {
            if(cursor <= 1) return; 
            cursor--;
            const lastEls = historyStack.pop();
            lastEls.forEach(el => el.remove());
            const prevStep = queue[cursor-1];
            if(prevStep && prevStep.explain) document.getElementById('explainText').innerHTML = prevStep.explain;
            document.getElementById('resultSection').classList.add('hidden');
            updateButtons();
        }

        function updateButtons() {
            document.getElementById('btnPrev').disabled = (cursor <= 1);
            const nextBtn = document.getElementById('btnNext');
            if(cursor >= queue.length) {
                nextBtn.disabled = true;
                document.getElementById('btnNextText').innerText = "ØªÙ… Ø§Ù„Ø­Ù„";
            } else {
                nextBtn.disabled = false;
                document.getElementById('btnNextText').innerText = "Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©";
            }
        }

        function showResults(crc) {
            const sec = document.getElementById('resultSection');
            sec.classList.remove('hidden');
            const title = document.getElementById('resTitle');
            const val = document.getElementById('finalFCS');
            const desc = document.getElementById('resDesc');
            
            val.innerText = crc;
            if(mode === 'tx') {
                title.innerText = "âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (Tx)";
                title.className = "text-2xl font-bold text-blue-800 mb-4";
                val.className = "text-6xl font-mono text-blue-600 font-bold tracking-[0.4em] mb-4 drop-shadow-sm break-all";
                desc.innerHTML = `Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø±Ø³Ù„Ø©: ${document.getElementById('inData').value}<span class="text-blue-600 font-bold bg-blue-50 px-1 rounded">${crc}</span>`;
            } else {
                let isZero = parseInt(crc) === 0;
                if(isZero) {
                    title.innerText = "ğŸ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø³Ù„ÙŠÙ…Ø© (No Error)";
                    title.className = "text-2xl font-bold text-emerald-800 mb-4";
                    val.className = "text-6xl font-mono text-emerald-600 font-bold tracking-[0.4em] mb-4 drop-shadow-sm break-all";
                    desc.innerText = "Ø§Ù„Ø¨Ø§Ù‚ÙŠ ØµÙØ± = ØªÙ…Ø§Ù….";
                } else {
                    title.innerText = "âš ï¸ Ø®Ø·Ø£ (Error Detected)";
                    title.className = "text-2xl font-bold text-red-800 mb-4";
                    val.className = "text-6xl font-mono text-red-600 font-bold tracking-[0.4em] mb-4 drop-shadow-sm break-all";
                    desc.innerText = "Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ù…Ø´ ØµÙØ± = Ø§Ø·Ù„Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„.";
                }
            }
            setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 100);
        }
        
        resetSim();

    </script>
</body>
</html>
